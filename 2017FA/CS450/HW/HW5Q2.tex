\documentclass[11pt]{article}
\input{../../packages.tex}
\pagestyle{fancy}
\fancyhead[L]{CS 450}
\fancyhead[C]{HW5Q2}
\fancyhead[R]{Lanxiao Bai}

\usepackage{listings}
\usepackage{color}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\allowdisplaybreaks[1]

\lstset{frame=tb,
  language=Python,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
}

\begin{document}
	Consider the implicit trapezoid method
	
	\[y_{k + 1} = y_k + h_k(\lambda y_k + \lambda y_{k + 1}) / 2\]
	
	and apply it to
	
	\[y' = \lambda y\]
	
	we get
	
	\[y_k = \left(\frac{1 + h\lambda/2}{1 - h\lambda / 2} \right)^k y_0\]
	
	We notice that the growing factor
	
	\begin{align}
		&\frac{1 + h\lambda/2}{1 - h\lambda / 2} = \left(1 + \frac{\lambda h}{2}\right)\left(1 + \frac{\lambda h}{2} + \left(\frac{\lambda h}{2}\right)^2 + \left(\frac{\lambda h}{2}\right)^3 + \cdots\right)\nonumber\\
		&\phantom{\frac{1 + h\lambda/2}{1 - h\lambda / 2}} = 1 + h\lambda + (h\lambda)^2 / 2 + (h\lambda)^3 / 4 + \cdots\nonumber
	\end{align}
	
	which is consistent to $e^{h\lambda}$ up until $h^2$ term, so the method has $2$nd order accuracy.
\end{document}
