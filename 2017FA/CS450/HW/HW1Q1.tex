\documentclass[11pt]{article}
\input{../../packages.tex}
\pagestyle{fancy}
\fancyhead[L]{CS 450}
\fancyhead[C]{HW1Q1}
\fancyhead[R]{Lanxiao Bai}

\usepackage{listings}
\usepackage{color}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\lstset{frame=tb,
  language=Python,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
}

\begin{document}
	\begin{enumerate}
		\item Considering the symmetric difference quotient approximation of 1st order derivative
		\[f'(x) \approx \frac{f(x + h) - f(x - h)}{2h}\]
		
		Accordingly, we have the 2nd order approximation 
		
		\begin{align}
			&f''(x) \approx \frac{f'(x + h) - f'(x - h)}{2h}\nonumber\\
			&\phantom{f''(x)} \approx \frac{f(x + h) - 2f(x) + f(x - h)}{h^2}
		\end{align}
	
	As a result, we see that
	\begin{align}
		&f'''(x) \approx \frac{f''(x + h) - f''(x - h)}{2h}\nonumber\\
		&\phantom{f'''(x)} \approx \frac{\frac{f(x + 2h) - 2f(x + h) + f(x)}{h^2} - \frac{f(x) - 2f(x - h) + f(x - 2h)}{h^2}}{2h}\nonumber\\
		&\phantom{f'''(x)} = \frac{f(x + 2h) - 2f(x + h) + f(x) - (f(x) - 2f(x - h) + f(x - 2h))}{2h^3}\nonumber\\
		&\phantom{f'''(x)} = \frac{f(x + 2h) - 2f(x + h) + 2f(x - h) - f(x - 2h)}{2h^3}
	\end{align}
	
	Thus, we see that it is an approximation of 3rd order derivative by symmetric difference quotient.
	
		\item By Taylor's Theorem, we have that 
			\[f(x + h) = f(x) + f'(x)h + f''(x)h^2 / 2 + f'''(x)h^3 / 6 + f^{(4)}(x)h^4 / 24 + f^{(5)}(\theta)h^5 / 120\]
						
		then we can calculate $(2)$ by
		
		\begin{align}
			&(2) = \frac{[f(x + 2h) - f(x + h)] + [f(x - h) - f(x + h)] + [f(x - h) - f(x - 2h)]}{2h^3}\nonumber\\
			&\phantom{(2)} = \frac{2f'''(x)h^3 + Mh^5 / 2}{2h^3}\nonumber\\
			&\phantom{(2)} = f'''(x) + Mh^2 / 4(\text{M is the upper bound of }f^{(5)}(\theta)\text{ term})\nonumber
		\end{align}
		
		Thus, we see that the truncation error is $O(h^2)$.
		
		\item Assume this algorithm has error of $\varepsilon$, then the round off would be 
			\[\text{error} \leq 6\varepsilon / 2h^3 = 3\varepsilon / h^3 \]
			
		\item According solutions to question of question 2 and 3, we have total error
			\[E = Mh^2/4 + 3\varepsilon / h^3\]
			
			so we let 
			\[E' = 0 \Rightarrow \frac{Mh}{2} - 9\varepsilon h^{-4} = 0 \Rightarrow h = (\frac{18\varepsilon}{M})^{-5} \]
		\item \[E = (\frac{18\cdot 2^{-52}}{M})^{-5}\]
	\end{enumerate}
\end{document}
